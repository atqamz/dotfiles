#!/usr/bin/env bash
set -euo pipefail

script_dir="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd)"
# shellcheck disable=SC1090
source "${BASH_COMMON:-$script_dir/bash-common}"

main() {
  require_cmd cliphist
  require_cmd wl-paste

  if has_cmd pkill; then
    pkill -f 'wl-paste --type text --watch cliphist store' || true
    pkill -f 'wl-paste --type image --watch cliphist store' || true
  fi

  wl-paste --type text --watch cliphist store &
  wl-paste --type image --watch cliphist store &
}

main "$@"
